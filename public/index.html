<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Casino Royale</title>
  <link rel="stylesheet" href="style.css" />
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
</head>
<body>
  <div class="casino-container">
    <div class="legend-box">
      <h3 class="section-title neon">Winning Combinations:</h3>
      <ul class="combo-list">
        <li>🍇 🍇 🍇 = Big Win!</li>
        <li>🍋 🍋 🍋 = Solid Win!</li>
        <li>🍒 🍒 🍒 = Nice Win!</li>
        <li>🍇 🍇 X = Small Win!</li>
        <li>🍋 🍋 X = Mini Win!</li>
        <li>🍒 🍒 X = Tiny Win!</li>
        <li class="jackpot-line">
          <span class="seven-icon"></span>
          <span class="seven-icon"></span>
          <span class="seven-icon"></span>
          = JACKPOT!
        </li>
      </ul>

      <hr class="legend-divider" />

      <div class="payout-info">
        <h4 class="section-title neon">Payout Info</h4>
        <ul class="rule-list">
          <li>
            <span class="dot">💠</span>
            <span>Wins pay a <b>% of the accumulated Jackpot</b></span>
          </li>
          <li class="jackpot-rule">
            <span class="dot">💠</span>
            <span class="jackpot-text">
              <span class="icons">
                <span class="seven-icon"></span>
                <span class="seven-icon"></span>
                <span class="seven-icon"></span>
              </span>
              <span>Jackpot Win</span>
            </span>
          </li>
          <li>
            <span class="dot">💠</span>
            <span>Jackpot refills from creator fees</span>
          </li>
          <li>
            <span class="dot">💠</span>
            <span><b>50%</b> → Jackpot &nbsp;|&nbsp; <b>50%</b> → Creator (fees reserve)</span>
          </li>
          <li>
            <span class="dot">💠</span>
            <span>Minimum payout: <b>0.001 SOL</b></span>
          </li>
          <li>
            <span class="dot">💠</span>
            <span>
              Holding more supply slightly increases your odds of winning
              <br/><span class="fair-note">(but not by much to keep it fair)</span>
            </span>
          </li>
        </ul>
      </div>
    </div>

    <div class="main-stage">
      <h1>Casino Royale</h1>
  <div id="token-ca-container" class="token-ca">CA: <span id="token-ca">loading...</span></div>
  <p class="register-instruction">To play you have to register the wallet you bought with. (Necessary step for leaderboard purposes)</p>


      <div id="timer">5</div>

      <!-- Casino dashboard info bar (MC removed) -->
      <div class="info-box">
        <div class="info-panel gold-bg">
          <span class="icon">👥</span>
          <span>Holders: <b id="holders">0</b></span>
        </div>
        <div class="divider"></div>
        <div class="info-panel gold-bg jackpot-panel">
          <span class="icon">💰</span>
          <span>Jackpot: <b id="jackpot" data-value="0">0</b> SOL</span>
        </div>
      </div>

      <div id="reels-container" class="gold-bg">
        <div id="win-line"></div>
      </div>

      <button id="play-btn">PLAY</button>

      <div id="result">Waiting for next spin...</div>

      <div class="history">
        <h3>Last Winners:</h3>
        <ul id="history-list"></ul>
      </div>

      <div class="leaderboard">
        <h3>Top 5 Winners:</h3>
        <ul id="leaderboard-list" class="gold-bg"></ul>
      </div>
    </div>
  </div>

  <!-- Sounds -->
  <audio id="spin-sound" src="spin.mp3"></audio>
  <audio id="small-win" src="small.mp3"></audio>
  <audio id="big-win" src="big.mp3"></audio>
  <audio id="jackpot-win" src="jackpot.mp3"></audio>
  <audio id="timer-sound" src="timer.mp3"></audio>
  <audio id="background-sound" src="background.mp3" loop></audio>

  <script src="script.js"></script>
  <script>
    // Jackpot number rolling animation
    function animateJackpot(newValue) {
      const el = document.getElementById("jackpot");
      const oldValue = parseFloat(el.dataset.value) || 0;
      const duration = 800; // ms
      const start = performance.now();

      function tick(now) {
        const progress = Math.min((now - start) / duration, 1);
        const current = oldValue + (newValue - oldValue) * progress;
        el.innerText = current.toFixed(3);
        if (progress < 1) requestAnimationFrame(tick);
      }
      requestAnimationFrame(tick);

      el.dataset.value = newValue;
    }
  </script>
</body>
</html>
